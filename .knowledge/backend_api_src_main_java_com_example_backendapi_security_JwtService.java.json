{"is_source_file": true, "format": "Java", "description": "This Java class 'JwtService' handles creation and validation of JWT tokens, including generating tokens with claims, validating token validity and extracting subjects. It uses the io.jsonwebtoken library for JWT operations.", "external_files": ["io.jsonwebtoken.Claims", "io.jsonwebtoken.Jwts", "io.jsonwebtoken.io.Decoders", "io.jsonwebtoken.security.Keys", "org.springframework.beans.factory.annotation.Value", "org.springframework.stereotype.Service", "javax.crypto.SecretKey", "java.time.Instant", "java.util.Date", "java.util.Map"], "external_methods": ["Decoders.BASE64.decode", "java.util.Base64.getEncoder", "java.util.Base64.encodeToString", "StandardCharsets.UTF_8", "Jwts.builder", "claims.getExpiration", "claims.getSubject", "Jwts.parser"], "published": ["generateToken", "isTokenValid", "extractSubject"], "classes": [{"name": "JwtService", "description": "Service responsible for creating and validating JWT access tokens, managing secret keys and token expiration logic."}], "methods": [{"name": "JwtService", "description": "Constructor initializing secretKey from a base64-encoded secret string and setting token expiry duration."}, {"name": "toBase64IfRaw", "description": "Encodes the secret string to base64 if it is not already base64-encoded."}, {"name": "generateToken", "description": "Generates a JWT token for a given subject and claims, with issued and expiration timestamps, signed with the secret key."}, {"name": "isTokenValid", "description": "Validates a token's authenticity, expiration and subject."}, {"name": "extractSubject", "description": "Extracts the subject from a JWT token."}, {"name": "parse", "description": "Parses the JWT token to obtain claims, verifying the token with the secret key."}], "calls": ["Decoders.BASE64.decode", "java.util.Base64.getEncoder", "java.util.Base64.encodeToString", "Jwts.builder", "claims.getExpiration", "claims.getSubject", "Jwts.parser"], "search-terms": ["JwtService", "JWT token creation", "JWT validation", "secret key initialization", "token claims", "token expiration"], "state": 2, "file_id": 25, "knowledge_revision": 56, "git_revision": "", "hash": "52d94600d48b6679e8ec01e9ff583bb4", "format-version": 4, "code-base-name": "backend_api", "filename": "backend_api/src/main/java/com/example/backendapi/security/JwtService.java", "revision_history": [{"56": ""}]}